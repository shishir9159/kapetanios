1. collect the information about in which repo all the packages belong and coalesce
2. wait for coredns to start before upgrading
3. mandatory triple buffering